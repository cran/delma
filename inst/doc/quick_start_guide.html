<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Martin Westgate" />

<meta name="date" content="2025-04-30" />

<title>Quick start guide</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Quick start guide</h1>
<h4 class="author">Martin Westgate</h4>
<h4 class="date">2025-04-30</h4>



<p>Ecological Metadata Language (EML) is a “comprehensive vocabulary and
a readable XML markup syntax for documenting research data” (<a href="https://doi.org/10.5063/F11834T2">Jones et al. 2019</a>).
Supplying metadata in this format is a requirement of several
data-sharing institutions, notably including the Global Biodiversity
Information Facility (<a href="https://gbif.org">GBIF</a>) and its
partner nodes. While the <a href="https://cran.r-project.org/package=EML">EML package</a> already
exists to support building and manipulating EML within the workspace,
there is no comparable system for writing these documents in a more
human-readable format, such as R Markdown or Quarto markdown.
<code>delma</code> provides this capability.</p>
<p>The default method for using <code>delma</code> is to:</p>
<ol style="list-style-type: decimal">
<li>Create a metadata statement template with
<code>use_metadata_template()</code></li>
<li>Edit metadata in your chosen IDE</li>
<li>Read the data into R with <code>read_md()</code></li>
<li>Write the data to an EML file with <code>write_eml()</code></li>
</ol>
<p>EML is quite stringent in the types of data that are allowed, as well
as their order and placement in the hierarchy. Getting these points
right can be challenging, and we suggest using
<code>check_metadata()</code> in combination with the <a href="https://eml.ecoinformatics.org">EML schema documentation</a> to
get it right.</p>
<div id="formatting-your-metadata-statement" class="section level2">
<h2>Formatting your metadata statement</h2>
<p>There are several points that are unusual about Rmarkdown documents
formatted using <code>delma</code>, which we discuss below</p>
<div id="document-structure" class="section level3">
<h3>Document structure</h3>
<p>Create a metadata statement template using
<code>use_metadata_template()</code></p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">use_metadata_template</span>(<span class="st">&quot;my-metadata-statement.Rmd&quot;</span>)</span></code></pre></div>
<p>Header levels in markdown-formatted metadata statements determine the
nested structure of the resulting xml. For example, this text in
markdown…</p>
<pre><code># EML

## Dataset

### Title
My title
</code></pre>
<p>…parses to this in xml.</p>
<pre><code>&lt;EML&gt;
  &lt;dataset&gt;
    &lt;title&gt;My title&lt;/title&gt;
  &lt;/dataset&gt;
&lt;EML&gt;</code></pre>
</div>
<div id="attributes" class="section level3">
<h3>Attributes</h3>
<p>Attributes can be added to a particular EML tag by including them in
a <code>list</code> within a code block, the <code>label</code> of which
is used by <code>delma</code> to link tags to their attributes. To add
attributes to the <code>userId</code> field, for example, you would add
the following code under the <code>## userId</code> heading:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode markdown"><code class="sourceCode markdown"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="in">#| label: &#39;userId&#39;</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="in">#| include: false</span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="in">list(directory = &quot;https://orcid.org&quot;)</span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="in">```</span></span></code></pre></div>
<p>The <code>include: false</code> tag is added so that this content
isn’t displayed when the document is knit.</p>
</div>
<div id="setting-a-unique-id" class="section level3">
<h3>Setting a unique ID</h3>
<p>Every EML document must open with the tag <code>eml</code>, and the
attributes of that element <strong>must</strong> contain a unique
identifier in the <code>packageId</code> field, as well as a link to the
system within which that key is unique. A logical example might be a
DOI:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode markdown"><code class="sourceCode markdown"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="in">#| label: &#39;eml&#39;</span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="in">#| include: false</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a><span class="in">list(packageId = &quot;https://doi.org/10.32614/CRAN.package.galah&quot;,</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a><span class="in">     system = &quot;https://doi.org&quot;)</span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="in">```</span></span></code></pre></div>
<p>A valid alternative might be a GitHub release:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode markdown"><code class="sourceCode markdown"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="in">#| label: &#39;eml&#39;</span></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a><span class="in">#| include: false</span></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a><span class="in">list(packageId = &quot;https://github.com/AtlasOfLivingAustralia/galah-R/releases/download/v2.1.0/galah_2.1.0.tar.gz&quot;,</span></span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a><span class="in">     system = &quot;https://github.com&quot;)</span></span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a><span class="in">```</span></span></code></pre></div>
<p>Note that the <code>eml</code> tag is unusual in <code>delma</code>
in that it is added automatically if not supplied. Where this occurs,
all tag levels are also incremented by one to account for this
change.</p>
</div>
<div id="dynamic-content" class="section level3">
<h3>Dynamic content</h3>
<p><code>delma</code> will call <code>rmarkdown::render()</code>
internally whenever <code>read_md()</code> or
<code>render_metadata()</code> is used, meaning that it is possible to
add dynamic content to your metadata statements. The boilerplate
statement that ships with delma uses this feature to automatically
populate the <code>Title</code> and <code>Pubdate</code> fields from the
<code>YAML</code> section, for example:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode markdown"><code class="sourceCode markdown"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="in">#| echo: false</span></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="in">#| results: &#39;asis&#39;</span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a><span class="in"># NOTE: This is set using the yaml above; do not edit by hand</span></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a><span class="in">cat(rmarkdown::metadata$date)</span></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a><span class="in">```</span></span></code></pre></div>
<p>You could also implement dynamic content using inline code. For
example:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>This data contains <span class="st">`</span><span class="at">r readr::read_csv(&quot;my_data.csv&quot;) |&gt; nrow()</span><span class="st">`</span> rows.</span></code></pre></div>
</div>
</div>
<div id="reading-writing-and-format-conversion" class="section level2">
<h2>Reading, writing, and format conversion</h2>
<p>Internally, <code>delma</code> uses the <a href="https://cran.r-project.org/package=lightparser">lightparser</a>
package to convert markdown files to <code>tibble</code>s, and the <a href="https://cran.r-project.org/package=xml2">xml2</a> package to
convert <code>list</code>s to xml and write them to file. Between these
two packages, we have written functions to convert between tibble and
list versions of EML-formatted markdown.</p>
<p>Under the hood, <code>read_md()</code>, which does a few things:</p>
<ul>
<li>calls <code>rmarkdown::render()</code> on your chosen file, meaning
any code blocks or inline code is executed properly.</li>
<li>appends code blocks whose <code>label</code> matches an EML tag to
the <code>attributes</code> of that EML tag; this allows quite complex
attribute addition without affecting rendered text.</li>
<li>‘cleans’ the imported tibble to a small number of required
columns.</li>
</ul>
<p>This tibble can then be rendered to EML using
<code>write_eml()</code>. The inverse operation is accomplished by
calling <code>read_eml()</code> followed by <code>write_md()</code>.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
